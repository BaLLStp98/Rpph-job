# ЁЯФз р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓ "Cannot GET /api/auth/callback/line"

## ЁЯЪи р╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣Ир╕Юр╕Ъ
- р╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Ф: "Cannot GET /api/auth/callback/line"
- NextAuth callback route р╣Др╕бр╣Ир╕Чр╕│р╕Зр╕▓р╕Щ
- Line OAuth р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Ц redirect р╕Бр╕ер╕▒р╕Ър╕бр╕▓р╣Др╕Фр╣Й

## тЬЕ р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╣Бр╕Бр╣Йр╣Др╕Вр╣Бр╕ер╣Йр╕з

### 1. **NextAuth Configuration** (`src/app/api/auth/[...nextauth]/route.ts`)
- р╣Ар╕Юр╕┤р╣Ир╕б `secret` р╣Бр╕ер╕░ `session.strategy`
- р╣Ар╕Юр╕┤р╣Ир╕б `jwt.secret` р╕кр╕│р╕лр╕гр╕▒р╕Ъ JWT signing
- р╣Ар╕Юр╕┤р╣Ир╕б debug mode р╕кр╕│р╕лр╕гр╕▒р╕Ъ development

### 2. **NextAuth Types** (`src/types/next-auth.d.ts`)
- р╣Ар╕Юр╕┤р╣Ир╕б `lineId`, `name`, `picture`, `provider` р╣Гр╕Щ JWT interface
- р╣Ар╕Юр╕┤р╣Ир╕б `lineId` р╣Гр╕Щ Session interface

### 3. **р╕лр╕Щр╣Йр╕▓р╕Чр╕Фр╕кр╕нр╕Ъ** (`src/app/test-auth/page.tsx`)
- р╕кр╕гр╣Йр╕▓р╕Зр╕лр╕Щр╣Йр╕▓р╕Чр╕Фр╕кр╕нр╕Ъ NextAuth
- р╣Бр╕кр╕Фр╕Зр╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ъ
- р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е Session р╣Бр╕ер╕░ Environment Variables

### 4. **р╕Ыр╕╕р╣Ир╕бр╕Чр╕Фр╕кр╕нр╕Ър╣Гр╕Щ Dashboard**
- р╣Ар╕Юр╕┤р╣Ир╕бр╕Ыр╕╕р╣Ир╕б "р╕Чр╕Фр╕кр╕нр╕Ъ NextAuth" р╣Гр╕Щр╕лр╕Щр╣Йр╕▓ Dashboard
- р╣Ар╕Юр╕┤р╣Ир╕бр╕Ыр╕╕р╣Ир╕б "р╕Чр╕Фр╕кр╕нр╕Ъ Line Login" р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Чр╕Фр╕кр╕нр╕Ъ Line OAuth

## ЁЯЫая╕П р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 1: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Др╕Яр╕ер╣М `.env`
```bash
# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕бр╕╡р╣Др╕Яр╕ер╣М .env р╣Бр╕ер╕░р╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Др╕гр╕Ъ
DATABASE_URL="mysql://root:@localhost:3306/mydata"
NEXT_PUBLIC_LIFF_ID=2007299644-z1G5LG7b
LINE_CLIENT_ID=2007299644
LINE_CLIENT_SECRET=b1eb1d21deb819cc3cd2999af9640f44
NEXTAUTH_SECRET=3jKf0U2PiXzNfqpqP/ciT4U9bflkq5nXGzW9cR0NQPo=
NEXTAUTH_URL=http://localhost:3000
```

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 2: р╕гр╕╡р╕кр╕Хр╕▓р╕гр╣Мр╕Ч Development Server
```bash
npm run dev
```

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 3: р╕Чр╕Фр╕кр╕нр╕Ъ NextAuth API
1. р╣Др╕Ыр╕Чр╕╡р╣И `http://localhost:3000/api/auth/test`
2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ API р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 4: р╕Чр╕Фр╕кр╕нр╕Ъ NextAuth Page
1. р╣Др╕Ыр╕Чр╕╡р╣И `http://localhost:3000/test-auth`
2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ъ
3. р╕Чр╕Фр╕кр╕нр╕Ър╕Ыр╕╕р╣Ир╕б "р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╕Фр╣Йр╕зр╕в Line"

## ЁЯФН р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ

### р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 1: р╕Чр╕Фр╕кр╕нр╕Ър╕Ьр╣Ир╕▓р╕Щ Dashboard
1. р╣Др╕Ыр╕Чр╕╡р╣Ир╕лр╕Щр╣Йр╕▓ Dashboard
2. р╕Др╕ер╕┤р╕Бр╕Ыр╕╕р╣Ир╕б "р╕Чр╕Фр╕кр╕нр╕Ъ NextAuth"
3. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Щр╕░р╣Бр╕ер╕░р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щ

### р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 2: р╕Чр╕Фр╕кр╕нр╕Ър╣Вр╕Фр╕вр╕Хр╕гр╕З
1. р╣Др╕Ыр╕Чр╕╡р╣И `http://localhost:3000/test-auth`
2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е Environment Variables
3. р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╕Фр╣Йр╕зр╕в Line

### р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣И 3: р╕Чр╕Фр╕кр╕нр╕Ъ API
1. р╣Др╕Ыр╕Чр╕╡р╣И `http://localhost:3000/api/auth/test`
2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ъ

## ЁЯЪи р╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Фр╕Чр╕╡р╣Ир╕нр╕▓р╕Ир╣Ар╕Бр╕┤р╕Фр╕Вр╕╢р╣Йр╕Щ

### 1. **"Cannot GET /api/auth/callback/line"**
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ development server р╕Чр╕│р╕Зр╕▓р╕Щр╕Чр╕╡р╣И port 3000
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Др╕Яр╕ер╣М `[...nextauth]/route.ts` р╕бр╕╡р╕нр╕вр╕╣р╣Ир╣Бр╕ер╕░р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Environment Variables

### 2. **"Invalid client_id" р╕лр╕гр╕╖р╕н "Invalid client_secret"**
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ `LINE_CLIENT_ID` р╣Бр╕ер╕░ `LINE_CLIENT_SECRET` р╣Гр╕Щ `.env`
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Гр╕Щ Line Developer Console

### 3. **"Invalid redirect_uri"**
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Callback URL р╣Гр╕Щ Line Developer Console
- р╕Хр╣Йр╕нр╕Зр╕Хр╕гр╕Зр╕Бр╕▒р╕Ъ `http://localhost:3000/api/auth/callback/line`

### 4. **NextAuth р╣Др╕бр╣Ир╕Чр╕│р╕Зр╕▓р╕Щ**
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ `SessionProvider` р╕Др╕гр╕нр╕Ъ `UserProvider` р╣Гр╕Щ `Providers.tsx`
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓ `Providers` р╕Цр╕╣р╕Бр╣Гр╕Кр╣Йр╣Гр╕Щ `layout.tsx`

## ЁЯУ▒ р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Line Developer Console

### 1. **р╕кр╕гр╣Йр╕▓р╕З Provider р╣Бр╕ер╕░ Channel**
1. р╣Др╕Ыр╕Чр╕╡р╣И [Line Developers Console](https://developers.line.biz/)
2. р╕кр╕гр╣Йр╕▓р╕З Provider р╣Гр╕лр╕бр╣И
3. р╕кр╕гр╣Йр╕▓р╕З Channel р╕Ыр╕гр╕░р╣Ар╕ар╕Ч "LINE Login"

### 2. **р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Callback URL**
- Callback URL: `http://localhost:3000/api/auth/callback/line`
- р╕кр╕│р╕лр╕гр╕▒р╕Ъ Production: р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Ар╕Ыр╣Зр╕Щ domain р╕Ир╕гр╕┤р╕З

### 3. **р╕Др╕▒р╕Фр╕ер╕нр╕Б Credentials**
- Channel ID тЖТ `LINE_CLIENT_ID`
- Channel Secret тЖТ `LINE_CLIENT_SECRET`

## ЁЯФЧ р╕ер╕┤р╕Зр╕Бр╣Мр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕З

- [Line Developers Console](https://developers.line.biz/)
- [NextAuth.js Documentation](https://next-auth.js.org/)
- [Line Login Documentation](https://developers.line.biz/en/docs/line-login/)

## ЁЯУЮ р╕Бр╕▓р╕гр╕Вр╕нр╕Др╕зр╕▓р╕бр╕Кр╣Ир╕зр╕вр╣Ар╕лр╕ер╕╖р╕н

р╕лр╕▓р╕Бр╕вр╕▒р╕Зр╕бр╕╡р╕Ыр╕▒р╕Нр╕лр╕▓:
1. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ console р╣Гр╕Щ browser
2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ terminal р╕Чр╕╡р╣Ир╕гр╕▒р╕Щ development server
3. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Network tab р╣Гр╕Щ Developer Tools
4. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Гр╕Щ Line Developer Console
5. р╣Гр╕Кр╣Йр╕лр╕Щр╣Йр╕▓р╕Чр╕Фр╕кр╕нр╕Ъ NextAuth р╣Ар╕Юр╕╖р╣Ир╕нр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕кр╕Цр╕▓р╕Щр╕░

## ЁЯОп р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╕Др╕▓р╕Фр╕лр╕зр╕▒р╕Зр╕лр╕ер╕▒р╕Зр╣Бр╕Бр╣Йр╣Др╕В

- тЬЕ NextAuth API р╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Й (`/api/auth/test`)
- тЬЕ р╕лр╕Щр╣Йр╕▓ NextAuth р╕Чр╕Фр╕кр╕нр╕Ър╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╣Др╕Фр╣Й (`/test-auth`)
- тЬЕ Line OAuth callback р╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Й (`/api/auth/callback/line`)
- тЬЕ р╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╕Фр╣Йр╕зр╕в Line р╕кр╕│р╣Ар╕гр╣Зр╕И
- тЬЕ Session р╕Цр╕╣р╕Бр╕кр╕гр╣Йр╕▓р╕Зр╣Бр╕ер╕░р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Др╕Фр╣Йр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
