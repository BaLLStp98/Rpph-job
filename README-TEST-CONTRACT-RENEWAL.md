# การทดสอบระบบ ContractRenewal

## ภาพรวม
เอกสารนี้อธิบายวิธีการทดสอบการดึงข้อมูลจากฐานข้อมูล ContractRenewal

## ฟังก์ชันที่สร้างขึ้น

### 1. ฟังก์ชันดึงข้อมูลทั้งหมด
```javascript
const fetchContracts = async () => {
  // ดึงข้อมูลจาก /api/contract-renewals
  // แปลงข้อมูลจาก ContractRenewal เป็น ContractData
  // แสดงข้อมูลในรูปแบบตาราง
}
```

### 2. ฟังก์ชันดึงข้อมูลตามสถานะ
```javascript
const fetchContractsByStatus = async (status) => {
  // ดึงข้อมูลตามสถานะ: PENDING, APPROVED, REJECTED, all
  // แปลงข้อมูลและแสดงผล
}
```

### 3. ฟังก์ชันดึงข้อมูลรายละเอียด
```javascript
const fetchContractDetails = async (contractId) => {
  // ดึงข้อมูลรายละเอียดการต่อสัญญาเฉพาะรายการ
}
```

### 4. ฟังก์ชันอัปเดตสถานะ
```javascript
const updateContractStatus = async (contractId, status, notes) => {
  // อัปเดตสถานะการต่อสัญญา
  // รีเฟรชข้อมูลหลังจากอัปเดต
}
```

### 5. ฟังก์ชันแสดงสถิติ
```javascript
const fetchContractRenewalStats = async () => {
  // ดึงสถิติข้อมูล ContractRenewal
  // แสดงจำนวนตามสถานะ
}
```

## การใช้งาน

### 1. เปิดหน้า Admin Contract Renewal
```
http://localhost:3000/admin/contract-renewal
```

### 2. ใช้ปุ่มกรองข้อมูล
- **รอดำเนินการ**: ดึงข้อมูลสถานะ PENDING
- **อนุมัติแล้ว**: ดึงข้อมูลสถานะ APPROVED  
- **ปฏิเสธแล้ว**: ดึงข้อมูลสถานะ REJECTED
- **ทั้งหมด**: ดึงข้อมูลทั้งหมด
- **รีเฟรช**: รีเฟรชข้อมูลใหม่

### 3. ดูข้อมูลใน Console
- เปิด Developer Tools (F12)
- ไปที่แท็บ Console
- ดูข้อมูลที่แสดงในรูปแบบตาราง

## การทดสอบด้วย Script

### 1. รันการทดสอบ
```bash
node test-contract-renewal.js
```

### 2. ดูผลลัพธ์
- ข้อมูลจะแสดงในรูปแบบตาราง
- สถิติข้อมูลจะแสดงในรูปแบบ JSON
- ข้อผิดพลาดจะแสดงในรูปแบบ error

## ข้อมูลที่แสดง

### 1. ข้อมูลพื้นฐาน
- ID การต่อสัญญา
- ชื่อ-นามสกุลพนักงาน
- หน่วยงาน
- ตำแหน่ง
- สถานะ

### 2. ข้อมูลสัญญา
- วันที่เริ่มสัญญาใหม่
- วันที่สิ้นสุดสัญญาใหม่
- เงินเดือนใหม่
- หมายเหตุ

### 3. ข้อมูลระบบ
- วันที่สร้าง
- วันที่อัปเดต
- จำนวนไฟล์แนบ

## การแก้ไขปัญหา

### 1. ข้อมูลไม่แสดง
- ตรวจสอบการเชื่อมต่อฐานข้อมูล
- ตรวจสอบ API endpoint
- ดู error ใน console

### 2. ข้อมูลไม่ถูกต้อง
- ตรวจสอบการแปลงข้อมูล
- ตรวจสอบ mapping ของฟิลด์
- ตรวจสอบการ format วันที่

### 3. การอัปเดตไม่ทำงาน
- ตรวจสอบ API endpoint
- ตรวจสอบการส่งข้อมูล
- ตรวจสอบการรีเฟรชข้อมูล

## การพัฒนาต่อ

### 1. เพิ่มการกรองข้อมูล
- กรองตามวันที่
- กรองตามหน่วยงาน
- กรองตามตำแหน่ง

### 2. เพิ่มการ export ข้อมูล
- Export เป็น Excel
- Export เป็น PDF
- Export เป็น CSV

### 3. เพิ่มการแจ้งเตือน
- แจ้งเตือนเมื่อมีข้อมูลใหม่
- แจ้งเตือนเมื่อสถานะเปลี่ยน
- แจ้งเตือนเมื่อใกล้หมดอายุ

## ตัวอย่างการใช้งาน

### 1. ดึงข้อมูลทั้งหมด
```javascript
fetchContracts();
```

### 2. ดึงข้อมูลตามสถานะ
```javascript
fetchContractsByStatus('PENDING');
```

### 3. ดึงข้อมูลรายละเอียด
```javascript
fetchContractDetails('contract-id');
```

### 4. อัปเดตสถานะ
```javascript
updateContractStatus('contract-id', 'APPROVED', 'อนุมัติแล้ว');
```

### 5. ดึงสถิติ
```javascript
fetchContractRenewalStats();
```

## หมายเหตุ

- ข้อมูลจะแสดงในรูปแบบตารางใน console
- ข้อมูลจะถูกแปลงจาก ContractRenewal เป็น ContractData
- การอัปเดตจะรีเฟรชข้อมูลอัตโนมัติ
- ข้อมูลจะถูกแสดงในรูปแบบที่อ่านง่าย
